影片剪輯工具規格書 v1.0

1. 目的與範圍

本工具用於：輸入一部影片與其字幕檔（SRT），由使用者指定一段或多段時間區間後，自動輸出對應的影片片段，並產出與片段同步的外掛字幕檔（.srt）。
本版本不包含字幕燒錄（burn-in）、不包含多段合併成單支影片。

⸻

2. 使用情境
	•	使用者想從一部長影片中擷取多段精華片段
	•	同時需要保留字幕，且字幕時間軸需從片段起點重新計時

⸻

3. 功能需求

3.1 輸入檔案
	1.	影片檔（必填）
	•	支援常見格式：.mp4, .mkv, .mov 等（依 ffmpeg 支援為準）
	2.	字幕檔（必填）
	•	格式：.srt
	•	編碼建議：UTF-8（若非 UTF-8，需在使用說明提醒使用者先轉檔）

3.2 時間區間輸入（裁切範圍）
	•	使用者可輸入一段或多段時間區間
	•	每段區間格式：
	•	HH:MM:SS -> HH:MM:SS
	•	例：00:01:10 -> 00:01:45
	•	一次輸入多段時，區間順序即為輸出序號順序

3.3 影片裁切（核心）
	•	每個時間區間輸出一支影片片段
	•	預設採快速裁切（copy stream）
	•	目標：速度快、畫質不變
	•	注意：因為關鍵影格限制，片段起訖時間可能存在極小偏差（在規格的限制與注意事項中說明）

3.4 字幕裁切與同步（核心）
	•	每個時間區間輸出一份字幕檔（.srt）
	•	字幕處理規則：
	1.	只保留與區間有交集的字幕段落
	2.	若字幕段落部分落在區間外，需將字幕時間裁切到區間內
	3.	產出字幕時間需以片段起點為 00:00:00 重新計時（時間軸平移）
	4.	字幕序號需重新從 1 開始連續編號
	•	字幕內容（文字）保持原樣，不做改寫、不做斷行重排

3.5 多段輸出策略
	•	多段輸入 → 多支輸出
	•	每段產出：
	•	clip_XXX.mp4
	•	clip_XXX.srt

⸻

4. 非功能需求

4.1 效能
	•	以快速裁切為預設，單段輸出時間以「接近複製檔案速度」為目標（視硬碟與影片大小而定）

4.2 相容性
	•	需依賴系統已安裝 ffmpeg（或可由工具提示使用者安裝）
	•	作業系統：macOS / Windows / Linux（以能執行 ffmpeg 為前提）

4.3 可用性
	•	提供清楚錯誤訊息，讓使用者知道是哪一個輸入錯（影片檔不存在、字幕檔不存在、時間格式錯誤、區間不合法等）
	•	輸出檔名規則清楚且不覆蓋原始檔

⸻

5. 輸入驗證規格

5.1 檔案驗證
	•	影片檔必須存在且可讀取
	•	字幕檔必須存在且可讀取
	•	若字幕檔非 SRT 格式：直接拒絕或提示「僅支援 .srt」

5.2 時間格式驗證
	•	僅接受 HH:MM:SS（兩位數時分秒）
	•	區間必須符合：start < end
	•	區間不可為空
-（選配）若可取得影片總長度：區間不得超出影片長度；否則提示錯誤

5.3 多段區間規則（本版本不強制，但需定義行為）
	•	允許重疊區間（視為獨立輸出）
	•	允許亂序區間（依輸入順序輸出）
	•	允許相同區間重複輸入（依輸入順序輸出）

⸻

6. 輸出規格

6.1 輸出資料夾
	•	使用者可指定 outdir
	•	若不存在，工具需自動建立

6.2 檔名規則
	•	每段輸出一組檔案：
	•	clip_001_... .mp4
	•	clip_001_... .srt
	•	檔名至少包含：序號（001/002/003…）
-（建議）可額外包含起訖時間或秒數，利於辨識（非必要但推薦）

6.3 輸出內容
	1.	影片片段
	•	保留原影片的音訊/影像串流（快速裁切 copy）
	2.	字幕片段
	•	只含該片段字幕，且時間軸從 00:00:00 起算

⸻

7. 錯誤處理與提示訊息

需至少涵蓋以下錯誤類型並提供可理解的訊息：
	•	找不到影片檔/字幕檔
	•	字幕檔格式不支援
	•	時間格式錯誤（非 HH:MM:SS）
	•	區間不合法（start >= end）
	•	ffmpeg 執行失敗（需回傳關鍵錯誤資訊）
	•	輸出資料夾無法建立或無寫入權限

⸻

8. 限制與注意事項（需寫在 README / 使用說明）
	•	本版本採用 快速裁切（-c copy），可能因關鍵影格造成：
	•	起始畫面可能略早或略晚於指定秒數
	•	字幕裁切是「按時間嚴格裁切」，若影片畫面有偏差，可能產生 0.x 秒左右的視覺落差
（此為 copy stream 的正常現象）
	•	僅支援 SRT 字幕（其他格式需先轉檔）
	•	不提供字幕燒錄、不提供多段合併

⸻

9. 驗收標準（測試案例）
	1.	單段裁切
	•	輸入 00:00:05 -> 00:00:10，輸出影片約 5 秒，字幕時間從 00:00:00 開始
	2.	多段裁切
	•	輸入兩段區間，輸出兩組 mp4+srt，序號對應正確
	3.	字幕交集裁切
	•	有字幕跨越區間邊界時，字幕時間被裁掉並重置
	4.	錯誤輸入
	•	00:10:00 -> 00:09:00 必須報錯
	•	影片/字幕路徑錯誤必須報錯